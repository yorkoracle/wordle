<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>York Wordle</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="logo.ico">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            touch-action: manipulation; /* Prevents double-tap to zoom on mobile */
        }

        .tile {
            transition: transform 0.6s, background-color 0.5s, border-color 0.5s;
            transform-style: preserve-3d;
        }

        .tile.flip {
            transform: rotateX(180deg);
        }

        .front, .back {
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
        }

        .back {
            transform: rotateX(180deg);
        }

        /* Custom Key Animation */
        .key-pop {
            animation: key-pop-animation 0.1s ease-out;
        }
        @keyframes key-pop-animation {
            0% { transform: scale(1); }
            50% { transform: scale(1.15); }
            100% { transform: scale(1); }
        }


    </style>
</head>
<body class="bg-zinc-900 text-white flex flex-col items-center justify-between min-h-screen p-2">

    <!-- Loading Screen -->
    <div id="loading-screen" class="fixed inset-0 bg-zinc-900 flex flex-col items-center justify-center z-50">
        <div class="text-center mb-8">
            <img src="logo.png" alt="Logo" class="w-24 h-24 object-contain mx-auto mb-6 animate-pulse">
            <h1 class="text-5xl font-bold tracking-wider mb-2">York Wordle</h1>
            <h3 class="text-lg font-medium tracking-wider text-zinc-400">Edited by Veer Bajaj</h3>
        </div>

        <!-- Start Button (hidden initially) -->
        <button id="start-button" class="hidden bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-4 px-8 rounded-lg transition-all transform hover:scale-105 text-xl">
            Start Game
        </button>
    </div>

    <!-- Header -->
    <header class="w-full max-w-md mx-auto py-4 border-b border-zinc-700">
        <div class="flex justify-between items-start mb-2">
            <button id="help-tab" class="text-zinc-400 hover:text-white transition-colors text-sm font-medium">
                Help
            </button>
            <div class="text-center">
                <h1 class="text-3xl md:text-4xl font-bold tracking-wider">York Wordle</h1>
                <h3 class="text-sm md:text-base font-medium tracking-wider text-zinc-400">
                    Edited by Veer Bajaj
                </h3>
            </div>
            <button id="credits-tab" class="text-zinc-400 hover:text-white transition-colors text-sm font-medium">
                Credits
            </button>
        </div>
    </header>


    <!-- Game Grid -->
    <main id="game-container" class="flex-grow flex items-center justify-center py-4">
        <div id="grid" class="grid grid-cols-5 gap-1.5" style="width: 330px; height: 390px;">
            <!-- Tiles will be generated by JavaScript -->
        </div>
    </main>

    <!-- On-screen Keyboard -->
    <div id="keyboard" class="w-full max-w-lg mx-auto mb-2">
        <!-- Keys will be generated by JavaScript -->
    </div>

    <!-- Message Toasts -->
    <div id="toast-container" class="fixed top-16 left-1/2 -translate-x-1/2 flex flex-col items-center gap-2"></div>

    <!-- Admin Modal (Hidden by default) -->
    <div id="admin-modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center hidden z-50">
        <div class="bg-zinc-800 rounded-lg shadow-xl p-8 text-center border border-zinc-600">
            <h2 class="text-2xl font-bold mb-4">Hello Veer.</h2>
            <p class="text-lg">The word of the day is:</p>
            <p id="secret-word-display" class="text-3xl font-bold text-emerald-400 tracking-widest my-4 bg-zinc-900 py-2 px-4 rounded-md"></p>
            <button onclick="document.getElementById('admin-modal').classList.add('hidden')" class="mt-4 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-6 rounded-lg transition-colors">
                Close
            </button>
        </div>
    </div>

    <!-- Hint Modal (Hidden by default) -->
    <div id="hint-modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center hidden z-50">
        <div class="bg-zinc-800 rounded-lg shadow-xl p-8 text-center border border-zinc-600 w-11/12 max-w-md">
            <h2 class="text-2xl font-bold mb-4 text-blue-400">üí° Smart User Hint</h2>
            <p class="text-lg mb-4">Here's a hint for today's word:</p>
            <p id="hint-text" class="text-xl font-bold text-emerald-400 tracking-wide my-4 bg-zinc-900 py-3 px-4 rounded-md"></p>
            <button onclick="document.getElementById('hint-modal').classList.add('hidden')" class="mt-4 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg transition-colors">
                Got it!
            </button>
        </div>
    </div>

    <!-- Game Over Modal (Hidden by default) -->
    <div id="game-over-modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center hidden z-50">
        <div class="bg-zinc-800 rounded-lg shadow-xl p-6 text-center border border-zinc-600 w-11/12 max-w-sm">
            <h2 id="modal-title" class="text-2xl font-bold mb-4">You Win!</h2>
            <div id="share-content" class="text-lg leading-relaxed font-mono whitespace-pre-wrap mb-6 p-4 bg-zinc-900 rounded-md">
                <!-- Share text will be generated here -->
            </div>
            <button id="share-button" class="w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3 px-6 rounded-lg transition-colors text-lg flex items-center justify-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path><polyline points="16 6 12 2 8 6"></polyline><line x1="12" y1="2" x2="12" y2="15"></line></svg>
                <span>Share</span>
            </button>
             <button onclick="document.getElementById('game-over-modal').classList.add('hidden')" class="mt-4 text-zinc-400 hover:text-white transition-colors">
                Close
            </button>
        </div>
    </div>

    <!-- Help Modal (Hidden by default) -->
    <div id="help-modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center hidden z-50">
        <div class="bg-zinc-800 rounded-lg shadow-xl p-6 text-center border border-zinc-600 w-11/12 max-w-md">
            <h2 class="text-2xl font-bold mb-4 text-blue-400">üìö How to Play</h2>
            <div class="text-left space-y-3 text-sm">
                <p><strong>Objective:</strong> Guess the 5-letter word in 6 tries or less.</p>
                <p><strong>How to play:</strong></p>
                <ul class="list-disc list-inside space-y-1 ml-2">
                    <li>Type letters using your keyboard or click the on-screen keys</li>
                    <li>Press ENTER to submit your guess</li>
                    <li>Press BACKSPACE to delete letters</li>
                </ul>
                <p><strong>Color meanings:</strong></p>
                <div class="space-y-1 ml-2">
                    <div class="flex items-center gap-2">
                        <div class="w-6 h-6 bg-emerald-600 rounded"></div>
                        <span>Letter is in the word and in the correct position</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-6 h-6 bg-amber-500 rounded"></div>
                        <span>Letter is in the word but in the wrong position</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-6 h-6 bg-zinc-700 rounded"></div>
                        <span>Letter is not in the word</span>
                    </div>
                </div>
                <p class="text-xs text-zinc-400 mt-4">Part of the <strong>York Oracle</strong> Games series.</p>
            </div>
            <button onclick="document.getElementById('help-modal').classList.add('hidden')" class="mt-6 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg transition-colors">
                Got it!
            </button>
        </div>
    </div>

    <!-- Credits Modal (Hidden by default) -->
    <div id="credits-modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center hidden z-50">
        <div class="bg-zinc-800 rounded-lg shadow-xl p-6 text-center border border-zinc-600 w-11/12 max-w-md">
            <h2 class="text-2xl font-bold mb-4 text-purple-400">üéØ Credits</h2>
            <div class="text-left space-y-3 text-sm">
                <div>
                    <p><strong>Developed by:</strong> Veer Bajaj</p>
                    <p class="text-zinc-400">Custom implementation of the popular Wordle game</p>
                </div>
                <div>
                    <p><strong>Original Wordle:</strong> Josh Wardle</p>
                    <p class="text-zinc-400">The New York Times Company</p>
                </div>
                <div>
                    <p><strong>Built with:</strong></p>
                    <ul class="list-disc list-inside ml-2 text-zinc-400">
                        <li>HTML5, CSS3, JavaScript (ES6+)</li>
                        <li>Tailwind CSS for styling</li>
                        <li>Custom animations and transitions</li>
                    </ul>
                </div>
                <div>

                <p class="text-xs text-zinc-500 text-center mt-4">Made with ‚ù§Ô∏è for word game enthusiasts</p>
            </div>
            <button onclick="document.getElementById('credits-modal').classList.add('hidden')" class="mt-6 bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-6 rounded-lg transition-colors">
                Close
            </button>
        </div>
    </div>

    <script type="module">
        
        import { ADMIN_CODE, HINT_CODE } from './src/data/index/info/config.js';

        document.addEventListener('DOMContentLoaded', () => {
            // --- LOADING SCREEN LOGIC ---
            const loadingScreen = document.getElementById('loading-screen');
            const startButton = document.getElementById('start-button');

            // Show start button after loading animation
            setTimeout(() => {
                startButton.classList.remove('hidden');
                startButton.classList.add('animate-pulse');
            }, 2000);

            // Start game when button is clicked
            startButton.addEventListener('click', () => {
                loadingScreen.style.transition = 'opacity 0.5s ease-out';
                loadingScreen.style.opacity = '0';
                setTimeout(() => {
                    loadingScreen.remove();
                }, 500);
            });

            // --- WORD LISTS ---
            // const VALID_WORDS = dictionary;
            // const DAILY_WORDS = dictionary.map(word => word.toUpperCase());

            // --- GAME STATE ---
            let guesses = Array(6).fill(null).map(() => Array(5).fill({ char: '', state: 'empty' }));
            let currentRow = 0;
            let currentTile = 0;
            let isGameOver = false;
            let secretWord = '';

            // --- ADMIN FEATURE ---
            let keySequence = [];
            let hintUsed = false;

            // --- DOM ELEMENTS ---
            const grid = document.getElementById('grid');
            const keyboard = document.getElementById('keyboard');
            const toastContainer = document.getElementById('toast-container');
            const adminModal = document.getElementById('admin-modal');
            const secretWordDisplay = document.getElementById('secret-word-display');
            const hintModal = document.getElementById('hint-modal');
            const hintText = document.getElementById('hint-text');
            const gameOverModal = document.getElementById('game-over-modal');
            const modalTitle = document.getElementById('modal-title');
            const shareContent = document.getElementById('share-content');
            const shareButton = document.getElementById('share-button');
            const helpTab = document.getElementById('help-tab');
            const creditsTab = document.getElementById('credits-tab');
            const helpModal = document.getElementById('help-modal');
            const creditsModal = document.getElementById('credits-modal');

            // --- INITIALIZATION ---
            // --- INITIALIZATION ---
            async function initializeGame() {
                try {
                    // Fetch and parse the word lists
                    const [solutionsResponse, guessesResponse] = await Promise.all([
                        fetch('./src/data/solutions.txt'),
                        fetch('./src/data/guesses.txt')
                    ]);

                    const solutionsText = await solutionsResponse.text();
                    const guessesText = await guessesResponse.text();

                    const solutions = solutionsText.split('\n').map(word => word.trim().toUpperCase()).filter(Boolean);
                    const guesses = guessesText.split('\n').map(word => word.trim().toUpperCase()).filter(Boolean);
                    
                    const DAILY_WORDS = solutions;
                    const VALID_WORDS = [...DAILY_WORDS, ...guesses];


                    secretWord = getWordOfTheDay(DAILY_WORDS);
                    hintUsed = false; // Reset hint usage for new game
                    createGrid();
                    createKeyboard();
                    setupEventListeners();
                    
                    // Now, make sure to pass DAILY_WORDS and VALID_WORDS to the functions that need them
                    // For example, you will need to update submitGuess to use VALID_WORDS
                    
                } catch (error) {
                    console.error("Failed to load word lists:", error);
                    showToast("Error: Could not load game words.");
                }
            }

            function getWordOfTheDay(DAILY_WORDS) {
                const startDate = new Date('2025-08-29T00:00:00Z');
                const now = new Date();

                // If it's before the start date, just return the first word.
                if (now < startDate) {
                    return DAILY_WORDS[0];
                }

                const diff = now - startDate;
                const oneDay = 1000 * 60 * 60 * 24;
                const dayIndex = Math.floor(diff / oneDay);
                const wordIndex = dayIndex % DAILY_WORDS.length;
                return DAILY_WORDS[wordIndex];
            }

               

            function generateHint(word) {
                const hints = [
                    `The word starts with "${word[0].toUpperCase()}" and ends with "${word[word.length - 1].toUpperCase()}"`,
                    `The word has ${word.length} letters`,
                    `The second letter is "${word[1].toUpperCase()}"`,
                    `The word contains the letters: ${word.split('').slice(0, 3).map(l => l.toUpperCase()).join(', ')}...`,
                    `Letters 2-4 are: ${word.slice(1, 4).toUpperCase()}`
                ];
                return hints[Math.floor(Math.random() * hints.length)];
            }

            // --- UI CREATION ---
            function createGrid() {
                for (let r = 0; r < 6; r++) {
                    for (let c = 0; c < 5; c++) {
                        const tileContainer = document.createElement('div');
                        tileContainer.classList.add('tile', 'relative', 'w-full', 'h-full');
                        tileContainer.dataset.row = r;
                        tileContainer.dataset.col = c;

                        const front = document.createElement('div');
                        front.classList.add('front', 'absolute', 'w-full', 'h-full', 'border-2', 'border-zinc-700', 'flex', 'items-center', 'justify-center', 'text-4xl', 'font-bold', 'transition-all', 'duration-100');

                        const back = document.createElement('div');
                        back.classList.add('back', 'absolute', 'w-full', 'h-full', 'border-2', 'border-zinc-700', 'flex', 'items-center', 'justify-center', 'text-4xl', 'font-bold');

                        tileContainer.appendChild(front);
                        tileContainer.appendChild(back);
                        grid.appendChild(tileContainer);
                    }
                }
            }

            function createKeyboard() {
                const keysLayout = [
                    'Q W E R T Y U I O P',
                    'A S D F G H J K L',
                    'ENTER Z X C V B N M BACKSPACE'
                ];
                keysLayout.forEach(row => {
                    const rowDiv = document.createElement('div');
                    rowDiv.classList.add('flex', 'justify-center', 'gap-1.5', 'my-1.5');
                    row.split(' ').forEach(key => {
                        const keyButton = document.createElement('button');
                        keyButton.textContent = key;
                        keyButton.id = `key-${key}`;
                        keyButton.classList.add('h-14', 'rounded-md', 'font-bold', 'uppercase', 'flex', 'items-center', 'justify-center', 'bg-zinc-600', 'hover:bg-zinc-500', 'transition-colors');
                        if (key.length > 1) {
                            keyButton.classList.add('px-3', 'text-xs');
                            keyButton.style.flexGrow = '1.5';
                        } else {
                            keyButton.classList.add('w-9');
                        }
                        keyButton.addEventListener('click', () => handleKeyPress(key));
                        rowDiv.appendChild(keyButton);
                    });
                    keyboard.appendChild(rowDiv);
                });
            }

            // --- EVENT HANDLING ---
            function setupEventListeners() {
                document.addEventListener('keydown', handleKeyDown);
                helpTab.addEventListener('click', () => {
                    helpModal.classList.remove('hidden');
                });
                creditsTab.addEventListener('click', () => {
                    creditsModal.classList.remove('hidden');
                });
            }

            function handleKeyDown(e) {
                // Cheat code sequence check - only track letter/number keys
                if (e.key.match(/^[a-zA-Z0-9]$/)) {
                    keySequence.push(e.key.toLowerCase());
                    const maxLength = Math.max(ADMIN_CODE.length, HINT_CODE.length);
                    if (keySequence.length > maxLength) {
                        keySequence.shift();
                    }

                    const sequence = keySequence.join('');
                    if (sequence.includes(ADMIN_CODE)) {
                        secretWordDisplay.textContent = secretWord;
                        adminModal.classList.remove('hidden');
                        keySequence = []; // Reset sequence
                    } else if (sequence.includes(HINT_CODE)) {
                        if (hintUsed) {
                            showToast("Hint already used this game!");
                        } else {
                            hintText.textContent = generateHint(secretWord);
                            hintModal.classList.remove('hidden');
                            hintUsed = true;
                        }
                        keySequence = []; // Reset sequence
                    }
                }

                if (isGameOver) return;

                if (e.key.match(/^[a-zA-Z]$/)) {
                    handleKeyPress(e.key.toUpperCase());
                } else if (e.key === 'Backspace') {
                    handleKeyPress('BACKSPACE');
                } else if (e.key === 'Enter') {
                    handleKeyPress('ENTER');
                }
            }

            function handleKeyPress(key) {
                if (isGameOver) return;

                const keyElement = document.getElementById(`key-${key}`);
                if(keyElement) {
                    keyElement.classList.add('key-pop');
                    setTimeout(() => keyElement.classList.remove('key-pop'), 100);
                }

                if (key === 'ENTER') {
                    submitGuess();
                } else if (key === 'BACKSPACE') {
                    deleteChar();
                } else if (currentTile < 5) {
                    addChar(key);
                }
            }

            // --- GAME LOGIC ---
            function addChar(char) {
                guesses[currentRow][currentTile] = { char, state: 'tbd' };
                updateGrid();
                currentTile++;
            }

            function deleteChar() {
                if (currentTile > 0) {
                    currentTile--;
                    guesses[currentRow][currentTile] = { char: '', state: 'empty' };
                    updateGrid();
                }
            }

            function submitGuess() {
                if (currentTile < 5) {
                    showToast("Not enough letters");
                    shakeRow(currentRow);
                    return;
                }

                const guessWord = guesses[currentRow].map(tile => tile.char).join('');

                if (!VALID_WORDS.includes(guessWord.toLowerCase())) {
                    showToast("Not in word list");
                    shakeRow(currentRow);
                    return;
                }

                evaluateGuess(guessWord);
            }

            function evaluateGuess(guessWord) {
                const secretWordLetters = secretWord.split('');
                const evaluation = Array(5).fill('absent');
                const letterCounts = {};

                // Count letters in secret word for accurate yellow/absent logic
                for (const letter of secretWordLetters) {
                    letterCounts[letter] = (letterCounts[letter] || 0) + 1;
                }

                // First pass for correct (green) letters
                for (let i = 0; i < 5; i++) {
                    if (guessWord[i] === secretWord[i]) {
                        evaluation[i] = 'correct';
                        letterCounts[guessWord[i]]--;
                    }
                }

                // Second pass for present (yellow) letters
                for (let i = 0; i < 5; i++) {
                    if (evaluation[i] !== 'correct' && secretWordLetters.includes(guessWord[i]) && letterCounts[guessWord[i]] > 0) {
                        evaluation[i] = 'present';
                        letterCounts[guessWord[i]]--;
                    }
                }

                flipAndColor(evaluation);
            }

            async function flipAndColor(evaluation) {
                const guess = guesses[currentRow];
                for (let i = 0; i < 5; i++) {
                    await new Promise(resolve => setTimeout(resolve, 300));
                    const tile = getTileElement(currentRow, i);
                    tile.classList.add('flip');
                    guess[i].state = evaluation[i];
                    updateTile(tile, guess[i]);
                    updateKeyboardKey(guess[i].char, guess[i].state);
                }

                checkGameOver();
            }

            function getDayNumber() {
                const startDate = new Date('2025-08-29T00:00:00Z');
                const now = new Date();

                // If it's before the start date, the day number is 1.
                if (now < startDate) {
                    return 1;
                }

                const diff = now - startDate;
                const oneDay = 1000 * 60 * 60 * 24;
                return Math.floor(diff / oneDay) + 1; // Day 1, Day 2, etc.
            }

            function generateShareText(didWin) {
                const dayNumber = getDayNumber();
                const score = didWin ? currentRow + 1 : 'X';
                let text = `York Wordle #${dayNumber} ${score}/6\n\n`;

                const emojiMap = {
                    correct: 'üü©',
                    present: 'üü®',
                    absent: '‚¨õ'
                };

                for (let i = 0; i <= currentRow; i++) {
                    for (let j = 0; j < 5; j++) {
                        text += emojiMap[guesses[i][j].state] || '‚¨õ';
                    }
                    text += '\n';
                }
                return text.trim();
            }

            function showGameOverModal(didWin) {
                modalTitle.textContent = didWin ? "Congratulations!" : "Nice Try!";
                const shareText = generateShareText(didWin);
                
                // Add the secret word to share content if player failed
                if (!didWin) {
                    shareContent.textContent = shareText + '\n\nThe word was: ' + secretWord;
                } else {
                    shareContent.textContent = shareText;
                }
                
                gameOverModal.classList.remove('hidden');

                shareButton.onclick = () => {
                    const textArea = document.createElement('textarea');
                    textArea.value = shareText;
                    textArea.style.position = 'fixed';
                    textArea.style.top = '0';
                    textArea.style.left = '0';
                    textArea.style.opacity = '0';
                    document.body.appendChild(textArea);
                    textArea.focus();
                    textArea.select();
                    try {
                        document.execCommand('copy');
                        showToast('Results copied to clipboard!');
                    } catch (err) {
                        console.error('Fallback: Oops, unable to copy', err);
                        showToast('Could not copy results.');
                    }
                    document.body.removeChild(textArea);
                };
            }

            function checkGameOver() {
                const guessWord = guesses[currentRow].map(tile => tile.char).join('');
                if (guessWord === secretWord) {
                    isGameOver = true;
                    danceRow(currentRow);
                    setTimeout(() => showGameOverModal(true), 2000); // Delay for animations
                } else if (currentRow === 5) {
                    isGameOver = true;
                     setTimeout(() => showGameOverModal(false), 2000); // Delay for animations
                } else {
                    currentRow++;
                    currentTile = 0;
                }
            }

            // --- UI UPDATES & ANIMATIONS ---
            function updateGrid() {
                for (let r = 0; r < 6; r++) {
                    for (let c = 0; c < 5; c++) {
                        const tile = getTileElement(r, c);
                        updateTile(tile, guesses[r][c]);
                    }
                }
            }

            function updateTile(tileElement, tileData) {
                const front = tileElement.querySelector('.front');
                const back = tileElement.querySelector('.back');

                front.textContent = tileData.char;
                back.textContent = tileData.char;

                // Reset classes
                front.classList.remove('border-zinc-500');
                back.classList.remove('bg-emerald-600', 'bg-amber-500', 'bg-zinc-700', 'border-emerald-600', 'border-amber-500', 'border-zinc-700');

                if (tileData.char) {
                    front.classList.add('border-zinc-500');
                }

                const stateColors = {
                    correct: 'bg-emerald-600 border-emerald-600',
                    present: 'bg-amber-500 border-amber-500',
                    absent: 'bg-zinc-700 border-zinc-700',
                };

                if (stateColors[tileData.state]) {
                    back.classList.add(...stateColors[tileData.state].split(' '));
                }
            }

            function updateKeyboardKey(key, state) {
                const keyElement = document.getElementById(`key-${key}`);
                if (!keyElement) return;

                const currentState = keyElement.dataset.state;
                const statePrecedence = { correct: 2, present: 1, absent: 0 };

                if (!currentState || statePrecedence[state] > statePrecedence[currentState]) {
                    keyElement.classList.remove('bg-zinc-600', 'bg-emerald-600', 'bg-amber-500', 'bg-zinc-800');
                    const keyColors = {
                        correct: 'bg-emerald-600',
                        present: 'bg-amber-500',
                        absent: 'bg-zinc-800'
                    };
                    keyElement.classList.add(keyColors[state]);
                    keyElement.dataset.state = state;
                }
            }

            function getTileElement(row, col) {
                return grid.querySelector(`[data-row='${row}'][data-col='${col}']`);
            }

            function showToast(message, duration = 1500) {
                const toast = document.createElement('div');
                toast.textContent = message;
                toast.classList.add('bg-zinc-100', 'text-zinc-900', 'font-bold', 'py-3', 'px-6', 'rounded-lg', 'shadow-lg', 'animate-pulse');
                toastContainer.prepend(toast);
                setTimeout(() => {
                    toast.style.transition = 'opacity 0.5s';
                    toast.style.opacity = '0';
                    setTimeout(() => toast.remove(), 500);
                }, duration);
            }

            function shakeRow(row) {
                const rowTiles = grid.querySelectorAll(`[data-row='${row}']`);
                rowTiles.forEach(tile => {
                    tile.style.animation = 'shake 0.5s';
                    tile.addEventListener('animationend', () => tile.style.animation = '', { once: true });
                });
            }

            function danceRow(row) {
                const rowTiles = grid.querySelectorAll(`[data-row='${row}']`);
                rowTiles.forEach((tile, index) => {
                    setTimeout(() => {
                        tile.style.animation = 'dance 0.5s';
                        tile.addEventListener('animationend', () => tile.style.animation = '', { once: true });
                    }, index * 100);
                });
            }

            // Add CSS for animations
            const style = document.createElement('style');
            style.innerHTML = `
                @keyframes shake {
                    10%, 90% { transform: translateX(-2px); }
                    20%, 80% { transform: translateX(4px); }
                    30%, 50%, 70% { transform: translateX(-8px); }
                    40%, 60% { transform: translateX(8px); }
                }
                @keyframes dance {
                    0%, 100% { transform: translateY(0); }
                    50% { transform: translateY(-15px); }
                }
            `;
            document.head.appendChild(style);

            // --- START THE GAME ---
            initializeGame();
        });
    </script>
</body>
</html>
